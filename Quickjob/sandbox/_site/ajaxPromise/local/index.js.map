{"version":3,"file":"index.js","sources":["../../../common/js/internal/ajax/_parseAjaxPromiseOptions.js","../../../common/js/internal/ajax/_handleAjaxRequest.js","../../../common/js/internal/ajax/_handleLegacyAjaxRequest.js","../../../common/js/internal/ajax/_handleDefaultAjaxRequest.js","../../../common/js/internal/ajax/_makeAjaxRequest.js","../../../common/js/internal/ajax/_makeLegacyAjaxRequest.js","../../../common/js/internal/ajax/_makeDefaultAjaxRequest.js","../../../common/js/ajaxPromise.js","../../../common/js/internal/nirvana/_getHtmlTagThatContains.js","../../../common/js/internal/nirvana/_getProductJsonFromProductInfo.js","../../../common/js/internal/nirvana/_parseNirvanaResponse.js","../../../common/js/scrapeNirvanaProduct.js","index.js"],"sourcesContent":["function _parseAjaxPromiseOptions(options) {\n\tlet defaultOptions = {\n\t\tuseCrossDomain: false,\n\t\ttimeout: 10000\n\t};\n\n\tif (options == null || typeof options === \"boolean\") {\n\t\tlet original = !!options;\n\t\toptions = Object.assign({}, defaultOptions);\n\t\toptions.useCrossDomain = original;\n\t}\n\telse {\n\t\toptions = Object.assign({}, defaultOptions, options);\n\t}\n\n\treturn options;\n}\n\nexport default _parseAjaxPromiseOptions;\n","function _handleAjaxRequest(evt, request, resolve, reject, timer, isLegacy) {\n\tif (isLegacy || request.readyState === XMLHttpRequest.DONE) {\n\t\tclearTimeout(timer);\n\n\t\tif (isLegacy ? evt.type === \"load\" : request.status >= 200 && request.status < 400) {\n\t\t\tresolve(request.responseText);\n\t\t}\n\t\telse if (!isLegacy || evt.type === \"error\") {\n\t\t\treject();\n\t\t}\n\t}\n}\n\nexport default _handleAjaxRequest;\n","import _handleAjaxRequest from \"./_handleAjaxRequest\";\n\nfunction _handleLegacyAjaxRequest(evt, request, resolve, reject, timer) {\n\treturn _handleAjaxRequest(evt, request, resolve, reject, timer, true);\n}\n\nexport default _handleLegacyAjaxRequest;\n","import _handleAjaxRequest from \"./_handleAjaxRequest\";\n\nfunction _handleDefaultAjaxRequest(evt, request, resolve, reject, timer) {\n\treturn _handleAjaxRequest(evt, request, resolve, reject, timer, false);\n}\n\nexport default _handleDefaultAjaxRequest;\n","import _handleLegacyAjaxRequest from \"./_handleLegacyAjaxRequest\";\nimport _handleDefaultAjaxRequest from \"./_handleDefaultAjaxRequest\";\n\nfunction _makeAjaxRequest(url, resolve, reject, options, isLegacy) {\n\tlet request = isLegacy ? new window.XDomainRequest() : new XMLHttpRequest(),\n\t\ttimer;\n\n\trequest.open(\"GET\", url, true);\n\n\tif (isLegacy) {\n\t\trequest.onload = evt => _handleLegacyAjaxRequest(evt, request, resolve, reject, timer);\n\t\trequest.onerror = evt => _handleLegacyAjaxRequest(evt, request, resolve, reject, timer);\n\t}\n\telse {\n\t\trequest.onreadystatechange = evt => _handleDefaultAjaxRequest(evt, request, resolve, reject, timer);\n\t}\n\n\tsetTimeout(() => request.send(), 0);\n\n\ttimer = setTimeout(function() {\n\t\treject();\n\t\trequest.abort();\n\t}, options.timeout);\n}\n\nexport default _makeAjaxRequest;\n","import _makeAjaxRequest from \"./_makeAjaxRequest\";\n\nfunction _makeLegacyAjaxRequest(url, resolve, reject, options) {\n\t_makeAjaxRequest(url, resolve, reject, options, true);\n}\n\nexport default _makeLegacyAjaxRequest;\n","import _makeAjaxRequest from \"./_makeAjaxRequest\";\n\nfunction _makeDefaultAjaxRequest(url, resolve, reject, options) {\n\t_makeAjaxRequest(url, resolve, reject, options, false);\n}\n\nexport default _makeDefaultAjaxRequest;\n","import _parseAjaxPromiseOptions from \"./internal/ajax/_parseAjaxPromiseOptions\";\nimport _makeLegacyAjaxRequest from \"./internal/ajax/_makeLegacyAjaxRequest\";\nimport _makeDefaultAjaxRequest from \"./internal/ajax/_makeDefaultAjaxRequest\";\n\nfunction ajaxPromise(url, options) {\n\toptions = _parseAjaxPromiseOptions(options);\n\n\treturn new Promise(function(resolve, reject) {\n\t\tif (window.XDomainRequest && options.useCrossDomain) {\n\t\t\t_makeLegacyAjaxRequest(url, resolve, reject, options);\n\t\t}\n\t\telse {\n\t\t\t_makeDefaultAjaxRequest(url, resolve, reject, options);\n\t\t}\n\t});\n}\n\nexport default ajaxPromise;\n","function _getHtmlTagThatContains(html, tagName, str) {\n\tlet regexStr = `<${tagName}[^>]*>((?:(?!<|${str})[\\\\s\\\\S])*(?:<(?!\\\\/?${tagName})[^>]*>(?:(?!<|${str})[\\\\s\\\\S])*)*${str}[\\\\s\\\\S]*?)<\\\\/${tagName}>`;\n\tlet regex = new RegExp(regexStr, \"gm\");\n\tlet match = regex.exec(html);\n\treturn (match != null) ? match[0] : undefined;\n}\n\nexport default _getHtmlTagThatContains;\n","import _getHtmlTagThatContains from \"./_getHtmlTagThatContains\";\n\nfunction _getProductJsonFromProductInfo(html) {\n\tif (html != null) {\n\t\tlet scriptTagStr = _getHtmlTagThatContains(html, \"json\", \"detail\");\n\n\t\tif (scriptTagStr != null) {\n\t\t\tlet objectStr = scriptTagStr.match(/{[\\s\\S]+}/gm)[0];\n\t\t\treturn JSON.parse(objectStr);\n\t\t}\n\t}\n}\n\nexport default _getProductJsonFromProductInfo;\n","import _getProductJsonFromProductInfo from \"./_getProductJsonFromProductInfo\";\n\nfunction _parseNirvanaResponse(url) {\n\treturn function(html) {\n\t\tlet productJson = _getProductJsonFromProductInfo(html);\n\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tif (productJson) {\n\t\t\t\tresolve(productJson.detail);\n\t\t\t}\n\t\t\telse {\n\t\t\t\treject();\n\t\t\t}\n\t\t});\n\t};\n}\n\nexport default _parseNirvanaResponse;\n","import ajaxPromise from \"./ajaxPromise\";\nimport _parseNirvanaResponse from \"./internal/nirvana/_parseNirvanaResponse\";\n\nconst scrapeNirvanaProduct = (url, options) => ajaxPromise(url, options).then(_parseNirvanaResponse(url));\n\nexport default scrapeNirvanaProduct;\n","import ajaxPromise from \"../../../common/js/ajaxPromise\";\nimport scrapeNirvanaProduct from \"../../../common/js/scrapeNirvanaProduct\";\n\najaxPromise(\"http://hmlbf.ellus.com/productInfo/46I865_534\", {\n\t\tuseCrossDomain: true\n\t})\n\t.then(data => console.log(data));\n\najaxPromise(\"teste.txt\")\n\t.then(data => console.log(data));\n\nscrapeNirvanaProduct(\"http://hmlbf.ellus.com/productInfo/46I865_534\", {\n\t\tuseCrossDomain: true\n\t})\n\t.then(data => console.log(data));\n"],"names":["_parseAjaxPromiseOptions","options","defaultOptions","original","Object","assign","useCrossDomain","_handleAjaxRequest","evt","request","resolve","reject","timer","isLegacy","readyState","XMLHttpRequest","DONE","type","status","responseText","_handleLegacyAjaxRequest","_handleDefaultAjaxRequest","_makeAjaxRequest","url","window","XDomainRequest","open","onload","onerror","onreadystatechange","send","setTimeout","abort","timeout","_makeLegacyAjaxRequest","_makeDefaultAjaxRequest","ajaxPromise","Promise","_getHtmlTagThatContains","html","tagName","str","regexStr","regex","RegExp","match","exec","undefined","_getProductJsonFromProductInfo","scriptTagStr","objectStr","JSON","parse","_parseNirvanaResponse","productJson","detail","scrapeNirvanaProduct","then","console","log","data"],"mappings":"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"}